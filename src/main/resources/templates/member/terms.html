<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{/layout/MemberLayout}">

<main class="content" id="member" layout:fragment="content">

	<div class="signup">
		<nav>
			<h1>약관동의</h1>
		</nav>
		<form id="termsForm" th:action="@{/member/register}" method="POST">
			<section>
				<h3><span class="essential">(필수)</span>사이트 이용약관</h3>


				<textarea th:if="${type == 'buyer'}" class="terms" readonly th:text="${termsResult.buyerterms}"></textarea>
				<textarea th:if="${type == 'seller'}" class="terms" readonly th:text="${termsResult.sellerterms}"></textarea>
				<label><input type="checkbox" id="agree1" name="agree1"/>동의합니다.</label>

				<h3><span class="essential">(필수)</span>전자금융거래 이용약관</h3>
				<textarea class="financial" readonly th:text="${termsResult.transaction}"></textarea>
				<label><input type="checkbox" id="agree2" name="agree2"/>동의합니다.</label>

				<h3><span class="essential">(필수)</span>개인정보 수집동의</h3>
				<textarea class="privacy" readonly th:text="${termsResult.privacy}"></textarea>
				<label><input type="checkbox" id="agree3" name="agree3"/>동의합니다.</label>
			</section>

			<section th:if="${type == 'buyer'}">
				<h3><span class="optional">(선택)</span>위치정보 이용약관</h3>
				<textarea class="location" readonly th:text="${termsResult.location}"></textarea>
				<label><input type="checkbox" id="agree4" name="agree4"/>동의합니다.</label>
			</section>

			<div>
				<input type="hidden" id="type" th:value="${type}" />
				<input type="button" class="agree" id="agreeButton" value="동의하기"/>
			</div>
		</form>
	</div>

	<script>
		document.getElementById('agreeButton').addEventListener('click', function() {
			var agreeTerms1 = document.getElementById('agree1');
			var agreeTerms2 = document.getElementById('agree2');
			var agreeTerms3 = document.getElementById('agree3');

			if (!agreeTerms1.checked || !agreeTerms2.checked || !agreeTerms3.checked) {

				alert('모든 필수 약관에 동의해야 가입할 수 있습니다.');
				return;
			}

			var type = document.getElementById('type').value;
			if (type === 'buyer') {
				window.location.href = '/lotteon/member/register';
			} else if (type === 'seller') {
				window.location.href = '/lotteon/member/registerSeller';
			}
		});
	</script>

</main>
</html>
